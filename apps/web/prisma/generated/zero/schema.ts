// This file was automatically generated by prisma-zero.
// You should NOT make any changes in this file as it will be overwritten.

import {
  boolean,
  createBuilder,
  createSchema,
  enumeration,
  json,
  number,
  relationships,
  string,
  table,
} from "@rocicorp/zero";

export type GameRoomStatus = "WAITING" | "PLAYING" | "FINISHED" | "DESTROYED";

export type GamePlayerStatus = "JOINED" | "READY" | "LEFT";

export const groupMembersTable = table("group_members")
  .columns({
    id: string(),
    group_id: string(),
    user_id: string(),
    joined_at: number().optional(),
    role: string().optional(),
  })
  .primaryKey("id");

export const groupsTable = table("groups")
  .columns({
    id: string(),
    name: string(),
    description: string().optional(),
    is_default: boolean().optional(),
    created_at: number().optional(),
  })
  .primaryKey("id");

export const messagesTable = table("messages")
  .columns({
    id: string(),
    group_id: string(),
    user_id: string(),
    content: string(),
    created_at: number().optional(),
  })
  .primaryKey("id");

export const usersTable = table("users")
  .columns({
    id: string(),
    username: string().optional(),
    email: string().optional(),
    avatar_url: string().optional(),
    created_at: number().optional(),
  })
  .primaryKey("id");

export const gameRoomsTable = table("game_rooms")
  .columns({
    id: string(),
    name: string(),
    host_id: string(),
    status: enumeration<GameRoomStatus>(),
    config: json().optional(),
    created_at: number().optional(),
    updated_at: number().optional(),
  })
  .primaryKey("id");

export const gamePlayersTable = table("game_players")
  .columns({
    id: string(),
    room_id: string(),
    user_id: string(),
    seat_number: number().optional(),
    status: enumeration<GamePlayerStatus>(),
    created_at: number().optional(),
    updated_at: number().optional(),
  })
  .primaryKey("id");

export const groupMembersTableRelationships = relationships(groupMembersTable, ({ one }) => ({
  groups: one({
    sourceField: ["group_id"],
    destField: ["id"],
    destSchema: groupsTable,
  }),
  users: one({
    sourceField: ["user_id"],
    destField: ["id"],
    destSchema: usersTable,
  })
}));
export const groupsTableRelationships = relationships(groupsTable, ({ many }) => ({
  group_members: many({
    sourceField: ["id"],
    destField: ["group_id"],
    destSchema: groupMembersTable,
  }),
  messages: many({
    sourceField: ["id"],
    destField: ["group_id"],
    destSchema: messagesTable,
  })
}));
export const messagesTableRelationships = relationships(messagesTable, ({ one }) => ({
  groups: one({
    sourceField: ["group_id"],
    destField: ["id"],
    destSchema: groupsTable,
  }),
  users: one({
    sourceField: ["user_id"],
    destField: ["id"],
    destSchema: usersTable,
  })
}));
export const usersTableRelationships = relationships(usersTable, ({ many }) => ({
  group_members: many({
    sourceField: ["id"],
    destField: ["user_id"],
    destSchema: groupMembersTable,
  }),
  messages: many({
    sourceField: ["id"],
    destField: ["user_id"],
    destSchema: messagesTable,
  }),
  hosted_rooms: many({
    sourceField: ["id"],
    destField: ["host_id"],
    destSchema: gameRoomsTable,
  }),
  game_players: many({
    sourceField: ["id"],
    destField: ["user_id"],
    destSchema: gamePlayersTable,
  })
}));
export const gameRoomsTableRelationships = relationships(gameRoomsTable, ({ one, many }) => ({
  host: one({
    sourceField: ["host_id"],
    destField: ["id"],
    destSchema: usersTable,
  }),
  players: many({
    sourceField: ["id"],
    destField: ["room_id"],
    destSchema: gamePlayersTable,
  })
}));
export const gamePlayersTableRelationships = relationships(gamePlayersTable, ({ one }) => ({
  room: one({
    sourceField: ["room_id"],
    destField: ["id"],
    destSchema: gameRoomsTable,
  }),
  user: one({
    sourceField: ["user_id"],
    destField: ["id"],
    destSchema: usersTable,
  })
}));
/**
 * The Zero schema object.
 * This type is auto-generated from your Prisma schema definition.
 */
export const schema = createSchema({
  tables: [
    groupMembersTable,
    groupsTable,
    messagesTable,
    usersTable,
    gameRoomsTable,
    gamePlayersTable,
  ],
  relationships: [
    groupMembersTableRelationships,
    groupsTableRelationships,
    messagesTableRelationships,
    usersTableRelationships,
    gameRoomsTableRelationships,
    gamePlayersTableRelationships,
  ],
});

/**
 * Represents the Zero schema type.
 * This type is auto-generated from your Prisma schema definition.
 */
export type Schema = typeof schema;
/**
 * Represents the ZQL query builder.
 * This type is auto-generated from your Prisma schema definition.
 */
export const zql = createBuilder(schema);
/**
 * Represents the Zero schema query builder.
 * This type is auto-generated from your Prisma schema definition.
 *
 * @deprecated Use `zql` instead.
 */
export const builder = zql;
/** Defines the default types for Zero */
declare module "@rocicorp/zero" {
  interface DefaultTypes {
    schema: Schema;
  }
}
